<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Enviando voto...</title>
<link rel="icon" type="image/png" sizes="32x32" href="favicon.png">

<style>
body{
    margin:0;
    font-family: Arial, sans-serif;
    background:#ffffff;
    text-align:center;
}

/* ===== BANNERS ===== */
.banner-top img,
.banner-bottom img{
    width:100%;
    height:auto;
    display:block;
}

/* ===== CONTENIDO CENTRAL ===== */
.contenido{
    padding:60px 20px;
}

.loader{
    border:6px solid #f3f3f3;
    border-top:6px solid #e91e63;
    border-radius:50%;
    width:70px;
    height:70px;
    animation:spin 1s linear infinite;
    margin:0 auto 25px auto;
}

@keyframes spin{
    0%{ transform:rotate(0deg); }
    100%{ transform:rotate(360deg); }
}

h2{
    margin:0;
    font-size:22px;
}

p{
    color:#555;
    margin-top:10px;
}

/* ===== BARRA ===== */
.progress-container{
    width:80%;
    max-width:400px;
    background:#eee;
    border-radius:20px;
    margin:30px auto;
    overflow:hidden;
}

.progress-bar{
    height:12px;
    width:0%;
    background:#e91e63;
    transition:width 0.3s ease;
}

/* ===== SPONSOR ===== */
.sponsor{
    margin-top:50px;
    background:#f9f9f9;
    padding:20px;
    border-radius:12px;
    display:inline-block;
    box-shadow:0 4px 15px rgba(0,0,0,0.08);
}

.sponsor img{
    max-width:200px;
    margin-top:10px;
}

.success{
    display:none;
    color:green;
    font-weight:bold;
    margin-top:15px;
    font-size:18px;
}

</style>
</head>

<body>

<div class="banner-top">
    <img src="banner.jpg" alt="Banner superior">
</div>

<div class="contenido">

    <div class="loader"></div>

    <h2>Enviando voto...</h2>
    <p>Por favor espera unos segundos</p>

    <div class="progress-container">
        <div class="progress-bar" id="progressBar"></div>
    </div>

    <div class="success" id="successMessage">
        ✔️ Voto recibido correctamente
    </div>

    <div class="sponsor">
        <strong>Patrocinador Oficial</strong>
        <br>
        <img src="sponsor.jpg" alt="Sponsor">
    </div>

</div>

<div class="banner-bottom">
    <img src="banner2.jpg" alt="Banner inferior">
</div>

<script>

// ===============================
// 1️⃣ VALIDAR SI SISTEMA CERRADO
// ===============================

fetch("config.json")
.then(res => res.json())
.then(config => {

    if(!config.votacion_abierta){
        window.location.href = "cerrado.html";
        return;
    }

    iniciarCarga();

})
.catch(() => {
    // si falla el json, permitir continuar
    iniciarCarga();
});


// ===============================
// 2️⃣ ANIMACIÓN + REDIRECCIÓN
// ===============================

function iniciarCarga(){

    let progress = 0;
    let bar = document.getElementById("progressBar");
    let success = document.getElementById("successMessage");

    let interval = setInterval(function(){
        progress += 5;
        bar.style.width = progress + "%";

        if(progress >= 100){
            clearInterval(interval);

            document.querySelector(".loader").style.display = "none";
            success.style.display = "block";

            setTimeout(function(){
                window.location.href = "gracias.html";
            }, 1200);
        }
    }, 120);

}

</script>

</body>
</html>
